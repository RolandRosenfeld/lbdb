#! @SH@
#
#     Copyright (C) 2025 gregor herrmann <gregoa@debian.org>
#                   2025 Roland Rosenfeld <roland@spinnaker.de>
#
#     This program is free software; you can redistribute it and/or modify
#     it under the terms of the GNU General Public License as published by
#     the Free Software Foundation; either version 2 of the License, or
#     (at your option) any later version.
#
#     This program is distributed in the hope that it will be useful,
#     but WITHOUT ANY WARRANTY; without even the implied warranty of
#     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#     GNU General Public License for more details.
#
#     You should have received a copy of the GNU General Public License along
#     with this program; if not, see <https://www.gnu.org/licenses/>.
#
m_notmuch_addrlookup_query() {
    NM=@NOTMUCH_ADDRLOOKUP@
    FORMAT=@NOTMUCH_ADDRLOOKUP_FORMAT@

    if [ -x "$NM" ]; then
        # 1d: remove first line (number of matches)
        # s/["<>]//g: remove all ", <, >
        # s/ *$/	/notmuch/: append TAB(notmuch) as 3rd column:
        $NM $FORMAT "$@" \
            | sed -e 1d \
                  -e 's/["<>]//g' \
                  -e 's/ *$/	notmuch/'
    fi
}
